# ClipFarmer

ClipFarmer is an end-to-end video processing system that converts long-form videos into short, vertical, attention-optimized clips for platforms like Reels, Shorts, and TikTok.

---

## Overview

ClipFarmer automates short-form content creation by:

- Detecting the loudest (most engaging) segment of a video
- Tracking faces frame-by-frame to keep the subject centered
- Cropping videos into a 9:16 vertical format
- Preserving original audio quality
- Producing ready-to-post clips

The system is deployed on AWS EC2 and powered by FastAPI, FFmpeg, MediaPipe, and a Next.js frontend.

---

## How It Works (Pipeline)

1. User uploads a video  
2. Audio analysis using FFmpeg  
3. Loudest 30-second segment is extracted  
4. Frame-by-frame face detection using MediaPipe  
5. Smooth center tracking  
6. Vertical cropping to 9:16  
7. Audio re-muxing  
8. Final processed output video  

---

## Architecture Overview

### Frontend
- Next.js (App Router)
- Deployed on Vercel
- Handles file selection, previews, and output playback

### Backend
- FastAPI (Python)
- Hosted on AWS EC2
- Handles video processing, ML inference, and FFmpeg orchestration

### Processing Stack
- FFmpeg — audio analysis and remuxing  
- MediaPipe (Face Detection) — subject tracking  
- OpenCV — frame-level manipulation  

---

## Running Locally

### Backend (Python)

**Requirements**
- Python 3.10+ (recommended)
- FFmpeg
- Linux / WSL / macOS

**Install dependencies**
```bash
pip install fastapi uvicorn mediapipe==0.10.14 opencv-python numpy
sudo apt install ffmpeg libgl1


Run
uvicorn main:app --host 0.0.0.0 --port 8000


API Docs
http://localhost:8000/docs

Frontend (Next.js)
cd frontend
npm install
npm run dev


Open:
http://localhost:3000

Deployment Notes:--
Backend (AWS EC2)
Runs continuously using tmux or systemd
Handles large uploads and long-running processing jobs
Designed to scale horizontally if needed

Frontend (Vercel)
Static + client-side rendering
Due to Vercel upload limits, large files should be uploaded directly to the backend or object storage (S3 / R2)

Known Limitations:-
Vercel API routes have upload size limits
MediaPipe can be unstable on Python 3.12 (Python 3.10 recommended)
Single-worker backend by design to avoid FFmpeg race conditions

Future Improvements:-
Progress tracking via WebSockets
Multiple clip generation per video
Direct uploads via S3 / Cloudflare R2
Multi-face prioritization
GPU acceleration
Batch processing and job queues (Celery / Redis)
Project Philosophy

ClipFarmer is not a demo script.
It is a production-style system that combines:
Real ML inference
Real video processing pipelines
Real cloud deployment
Real frontend–backend integration
It reflects how modern AI-powered media products are actually built.

Author
Basit Warsi
CSE @ IIT Jammu

Interests: Applied ML, Video Intelligence, Systems, Startups
